{% extends "layout.html" %}

{% block content %}
<style>
    /* Sirf Home Page ka Design */
    .hero-section { padding: 80px 20px; text-align: center; }
    .gradient-text { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 800; }
    .downloader-box { max-width: 700px; margin: 40px auto; background: #1e293b; padding: 10px; border-radius: 16px; display: flex; gap: 10px; border: 1px solid #334155; }
    .url-input { background: transparent; border: none; color: white; padding: 15px; flex-grow: 1; outline: none; }
    .format-select { background: #0f172a; color: white; border: none; padding: 0 15px; border-radius: 8px; }
    .btn-process { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); border: none; padding: 12px 30px; border-radius: 10px; color: white; font-weight: 600; }
    
    #result-area { display: none; max-width: 500px; margin: 30px auto; background: #1e293b; border-radius: 15px; padding: 20px; border: 1px solid #334155; }
    .dl-btn { display: block; background: #10b981; color: white; padding: 12px; border-radius: 8px; text-decoration: none; font-weight: bold; margin-top: 10px; text-align: center; }
</style>

<div class="hero-section">
    <span class="badge rounded-pill bg-primary bg-opacity-25 text-primary mb-3 px-3 py-2">V 3.0 - PRO</span>
    <h1 class="display-4 fw-bold">Download Social Media</h1>
    <h1 class="display-4 fw-bold gradient-text mb-4">Without Watermark</h1>
    <p class="text-secondary lead mb-5">Paste links from TikTok, Instagram, YouTube & Facebook.</p>

    <div class="downloader-box">
        <input type="text" id="url-input" class="url-input" placeholder="Paste link here...">
        <select id="format-select" class="format-select">
            <option value="video">Video (HD)</option>
            <option value="audio">Audio (MP3)</option>
        </select>
        <button onclick="downloadMedia()" id="btn-action" class="btn-process">Start ></button>
    </div>

    <div id="loading" class="mt-4" style="display: none;">
        <div class="spinner-border text-primary" role="status"></div>
    </div>

    <div id="result-area">
        <img id="thumb" src="" class="w-100 rounded mb-3">
        <h5 id="title" class="text-white mb-3">Title</h5>
        <a id="dl-link" href="#" class="dl-btn" target="_blank">Download</a>
    </div>
</div>

<script>
    async function downloadMedia() {
        // (Yahan wohi purana JS code jo pehle diya tha - Logic same rahegi)
        const input = document.getElementById('url-input');
        const format = document.getElementById('format-select');
        const btn = document.getElementById('btn-action');
        const loading = document.getElementById('loading');
        const result = document.getElementById('result-area');

        if (!input.value) { alert("Please paste a link!"); return; }

        btn.disabled = true; btn.innerText = '...';
        loading.style.display = 'block'; result.style.display = 'none';

        try {
            const response = await fetch('/get-video', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ url: input.value, type: format.value })
            });
            const data = await response.json();
            
            loading.style.display = 'none'; btn.disabled = false; btn.innerText = 'Start >';

            if (data.error) { alert(data.error); } 
            else {
                document.getElementById('thumb').src = data.thumbnail;
                document.getElementById('title').innerText = data.title;
                document.getElementById('dl-link').href = data.download_url;
                result.style.display = 'block';
            }
        } catch (e) { alert("Error"); loading.style.display = 'none'; btn.disabled = false; }
    }
</script>
{% endblock %}